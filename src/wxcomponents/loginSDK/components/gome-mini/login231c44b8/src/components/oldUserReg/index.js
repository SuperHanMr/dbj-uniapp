var window=window||{};window.webpackJsonp=require("../../../../../../bundle.js"),module.exports=(window.webpackJsonp=window.webpackJsonp||[]).push([["components/gome-mini/login231c44b8/src/components/oldUserReg/index"],{"../../node_modules/@mpxjs/webpack-plugin/lib/native-loader.js!./src/components/oldUserReg/index.js?packageName=main":function(e,t,o){"use strict";o.r(t),function(e){e.currentModuleId="mbda24956",e.currentCtor=Component,e.currentCtorType="component",e.currentSrcMode="wx";o("./src/components/oldUserReg/index.js?packageName=main&resourcePath=%2FUsers%2Ffwind%2Fgome%2Fgitlab%2Fgome-mini%2Fpackages%2Flogin%2Fsrc%2Fcomponents%2FoldUserReg%2Findex.js");e.currentModuleId}.call(this,o("../../node_modules/webpack/buildin/global.js"))},"./src/components/oldUserReg/index.js?packageName=main&resourcePath=%2FUsers%2Ffwind%2Fgome%2Fgitlab%2Fgome-mini%2Fpackages%2Flogin%2Fsrc%2Fcomponents%2FoldUserReg%2Findex.js":function(e,t,o){"use strict";var n=o("./src/utils/apis.js"),a=o("./src/utils/regular.js"),i=o("./src/utils/index.js");Component({properties:{loginData:{type:Object,value:{}}},data:{height:0,title:"",isShowWarning:!0,identifyLevel:!1,showLayer:!1,phone:"",code:"",codeTxt:"获取验证码",codeIsClick:!0,confirmIsClick:!0,countdownValue:120,codeHide:!1,countdownHide:!1,phoneClear:!1,codeClear:!1,countdown:120,phoneFocus:!1,bindState:!1,platForm:""},lifetimes:{attached(){let e="",t=Object(i.b)("identifyLevel"),o=Object(i.b)("isShowWarning");const{appId:n,ctx:a,imgHeight:s,imgUrl:c,imgWidth:d,sharerUnionId:r,sharerUserId:l,code:h,platForm:u,whereFromStr:m}=this.data.loginData;105==h?e="请绑定一个真快乐账号，此手机号可用于登录和找回密码。":106==h&&(e="为了保障您的账号安全，请完善手机号，此手机号可用于登录和找回密码。"),t=2==t||1==t,"Y"==o&&(o=!0),this.setData({title:e,identifyLevel:t,isShowWarning:o,appId:n,ctx:a,imgUrl:c,imgWidth:d,imgHeight:s,sharerUnionId:r,sharerUserId:l,platForm:u,whereFromStr:m}),wx.setNavigationBarTitle({title:e})}},methods:{bindPhoneInput:function(e){let t=!0;const o=e.detail.value,n=o.length;11==n&&(t=!1),this.setData({phone:o,codeIsClick:t,phoneClear:!!n}),this.dealConfirmIsClick()},bindPhoneFocus:function(e){const t=e.detail.value;this.setData({phoneClear:!!t})},bindPhoneBlur:function(e){const t=e.detail.value;this.setData({phoneClear:!!t})},bindCodeInput:function(e){const t=e.detail.value,o=t.length,{phone:n}=this.data;11==n.length&&Object(a.b)(n)?wx.showToast({title:"手机号错误",icon:"none"}):this.setData({code:t,codeClear:!!o}),this.dealConfirmIsClick()},bindCodeFocus:function(e){const t=e.detail.value;this.setData({codeClear:!!t})},bindClearPhone:function(){this.setData({phone:"",phoneClear:!1,codeIsClick:!0}),this.dealConfirmIsClick(),Object(i.c)()},bindClearCode:function(){this.setData({code:"",codeClear:!1}),this.dealConfirmIsClick(),Object(i.c)()},bindCodeBlur:function(e){const t=e.detail.value;this.setData({codeClear:!!t.length})},getCodeEvent:function(e){let t=this;const{appId:o,phone:i,codeIsClick:s,showLayer:c,whereFromStr:d,platForm:r,ctx:l}=this.data;if(s)wx.showToast({title:"请输入手机号",icon:"none"});else if(Object(a.b)(i))wx.showToast({title:"手机号错误",icon:"none"});else{const a={appId:o,mobile:i};d&&(a.whereFrom=d),c?this.setData({showLayer:!1}):(a.isValidatePhone=1,a.isChangeBind="wx"==r?e:""),n.a.sendSMSOnBind(a,l,{success(e){1!=e.data.isShow||c?t.triggerEvent("oldGetCode",{res:e}):t.setData({showLayer:!0})},catch(e){wx.showToast({title:"获取验证码失败，请稍后再试",icon:"none"})}})}},dealCountdown:function(){let e=this;e.data.countdownValue>1?(e.data.countdownValue--,e.setData({codeIsClick:!0,codeTxt:`${e.data.countdownValue}s`}),setTimeout((function(){e.dealCountdown()}),1e3)):e.setData({codeIsClick:!1,countdownHide:!1,countdownValue:120,codeTxt:"重新获取"})},resetCountdown:function(){this.countdownValue=120,this.setData({countdown:this.countdownValue,codeHide:!1,codeTxt:"重新获取",countdownHide:!0})},dealConfirmIsClick:function(){const{phone:e,code:t}=this.data,o=!Object(a.d)(t);let n=!0;11!=e.length||o||(n=!1),this.setData({confirmIsClick:n})},closeLayer:function(){this.setData({showLayer:!1,bindState:!1})},stepoverBind:function(){const{platForm:e,whereFromStr:t}=this.data,o={puserId:Object(i.b)("sharerUserId"),headimg:"ali"==e?Object(i.b)("userInfo").avatar:Object(i.b)("userInfo").avatarUrl,snsUserName:Object(i.b)("userInfo").nickName};t&&(o.whereFrom=t),n.a.stepoverBind(o,{success(e){const{code:t,SCN:o,gradeNO:n,gradeName:a,loginName:s,message:c}=e.data;200==t?(Object(i.d)("scn",o),Object(i.d)("date",Date.now()),Object(i.d)("memberInfo",{gradeNO:n||"",gradeName:a||"",loginName:s||""}),wx.navigateBack({delta:2})):403==t?wx.redirectTo({url:"../loginEmpower/loginEmpower"}):wx.showToast({title:c,icon:"none"})}})},callPhone:function(e){const t=e.target.dataset.phone;wx.makePhoneCall({phoneNumber:t})},doneEvent:function(){const e=this,{appId:t,phone:o,code:s,whereFromStr:c,platForm:d,ctx:r}=this.data;if(Object(a.b)(o)||11!=o.length)wx.showToast({title:"请输入正确的手机号",icon:"none"});else if(6!=s.length)wx.showToast({title:"请输入验证码",icon:"none"});else{const a=Object(i.b)("userInfo"),l=Object(i.b)("sharerUserId"),{avatar:h,avatarUrl:u,nickName:m}=a,p={appId:t,mobile:o,msgCode:s,puserId:l,headimg:"ali"==d?h:u,snsUserName:m};c&&(p.whereFrom=c),n.a.activeMobile(p,r,{success(t){e.triggerEvent("oldActiveMobile",{res:t})}})}},switchDiffAuthory:function(){this.setData({showLayer:!1,isShowAuthoryPhone:!1,bindState:!1,phone:"",phoneClear:!1})},bindPhoneEvent:function(){this.setData({bindState:!1}),this.getCodeEvent(1)},tipsShowModal(e){let t=this;wx.showModal({title:"提示",content:e,cancelText:"更换号码",confirmText:"联系客服",confirmColor:"#F66A6B",success:function(e){e.confirm?wx.makePhoneCall({phoneNumber:"400-811-3333"}):e.cancel&&t.setData({phone:"",code:"",phoneClear:!1,codeClear:!1,codeTxt:"获取验证码",codeIsClick:!1,countdown:120,phoneFocus:!0})}})}}})}},[["../../node_modules/@mpxjs/webpack-plugin/lib/native-loader.js!./src/components/oldUserReg/index.js?packageName=main","bundle"]]]);
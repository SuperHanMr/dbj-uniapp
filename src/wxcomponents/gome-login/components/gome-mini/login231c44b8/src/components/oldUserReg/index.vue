<template>
<uni-shadow-root class="gome-login-components-gome-mini-login231c44b8-src-components-oldUserReg-index"><view class="container" :style="'height:'+(height)+';'+(themeStyle)"><view class="cont"><view class="tit-log"><image src="/img/logo.0ccb88de.png" :style="'width:'+(imgWidth)+'rpx; height:'+(imgHeight)+'rpx;'"></image></view> <view class="cont-box"><view class="tips">{{title}}</view> <view class="verify-boxs"><view class="input-phone"><image class="icon" src="/img/ico-phone.23a4ec5d.png"></image> <input class="phone" type="number" placeholder="请输入手机号码" placeholder-style="color: #bfbfbf;" maxlength="11" @input="bindPhoneInput" @focus="bindPhoneFocus" @blur="bindPhoneBlur" :value="phone" :focus="phoneFocus"></input> <image :class="'clear '+(phoneClear ? 'show' : '')" src="/img/close-icon.fc45a809.png" @click="bindClearPhone"></image></view></view> <view class="verify-boxs"><view class="input-verify"><image class="icon" src="/img/ico-code.1a904e9d.png"></image> <input class="verify" type="number" placeholder="请输入验证码" placeholder-style="color: #bfbfbf;" maxlength="6" @input="bindCodeInput" @focus="bindCodeFocus" @blur="bindCodeBlur" :value="code"></input> <image :class="'clear '+(codeClear ? 'show' : '')" src="/img/close-icon.fc45a809.png" @click="bindClearCode"></image></view> <button class="verify-sends" @click="getCodeEvent" :disabled="codeIsClick">{{codeTxt}}</button></view></view> <button class="done" :disabled="confirmIsClick" @click="doneEvent">完成</button> <view class="skip" v-if="identifyLevel"><view class="skip-btn" @click="skipEvnet">跳过</view></view></view> <view class="layer" :style="'height:'+(height)" v-if="showLayer && isShowWarning"><view class="layer-cont"><view class="layer-h1"><view class="h1">临时账号绑定真快乐账号须知</view> <image @click="closeLayer" src="/img/close.5bdc4fee.png"></image></view> <scroll-view class="close-cont" scroll-y><view class="info-tit">1）临时账号是指在2017年2月23日以前，您通过第三方平台账户（微信、QQ、支付宝、微博等）直接进入真快乐平台购物时系统自动生成的账号。</view> <view class="info-tit">2）真快乐账号和临时账号是两个独立账号，真快乐账号无法直接查看临时账号的订单、资产等信息，如您需查看临时账号的订单、资产等信息，请您直接登录您的临时账号。</view> <view class="info-tit">3）如需登录之前的临时账号，请将该临时账号与真快乐账号进行解绑，或者拨打<view class="call-phone" @click="callPhone" data-phone="400-811-3333">400-811-3333</view>联系客服解决。</view> <view class="info-tit">4）绑定后产生的一切后果（包括但不限于真快乐券、真快乐豆等失去效力等问题）由您承担，真快乐平台对您不承担任何责任。</view> <view class="info-tit">请您知悉！</view></scroll-view></view> <view class="bind-btn"><view class="change-phone" @click="switchDiffAuthory">更换手机号</view> <view class="bind-phones" @click="getCodeEvent">继续绑定</view></view></view> <view class="bind-mask" v-if="bindState"><view class="bind-box"><view class="bind-tit"><view>更换绑定第三方平台账号须知</view> <image @click="closeLayer" src="/img/close.5bdc4fee.png"></image></view> <view class="layer-h2"><view>变更绑定同一第三方平台账号须知如下：</view> <view>1）变更后您的资产不发生任何变化。</view> <view>2）变更绑定同一第三方平台内账号的30天内无法进行二次解绑。</view> <view>请您知悉。</view></view></view> <view class="bind-btn"><view class="change-phone" @click="switchDiffAuthory">更换手机号</view> <view class="bind-phones" @click="bindPhoneEvent">继续绑定</view></view></view></view></uni-shadow-root>
</template>

<script>

global['__wxRoute'] = 'gome-login/components/gome-mini/login231c44b8/src/components/oldUserReg/index'
var window=window||{};window.webpackJsonp=require("../../../../../../bundle.js"),module.exports=(window.webpackJsonp=window.webpackJsonp||[]).push([["components/gome-mini/login231c44b8/src/components/oldUserReg/index"],{"../../node_modules/@mpxjs/webpack-plugin/lib/native-loader.js!./src/components/oldUserReg/index.js?packageName=main":function(e,t,o){"use strict";o.r(t),function(e){e.currentModuleId="mbda24956",e.currentCtor=Component,e.currentCtorType="component",e.currentSrcMode="wx";o("./src/components/oldUserReg/index.js?packageName=main&resourcePath=%2FUsers%2Ffwind%2Fgome%2Fgitlab%2Fgome-mini%2Fpackages%2Flogin%2Fsrc%2Fcomponents%2FoldUserReg%2Findex.js");e.currentModuleId}.call(this,o("../../node_modules/webpack/buildin/global.js"))},"./src/components/oldUserReg/index.js?packageName=main&resourcePath=%2FUsers%2Ffwind%2Fgome%2Fgitlab%2Fgome-mini%2Fpackages%2Flogin%2Fsrc%2Fcomponents%2FoldUserReg%2Findex.js":function(e,t,o){"use strict";var n=o("./src/utils/apis.js"),a=o("./src/utils/regular.js"),i=o("./src/utils/index.js");Component({properties:{loginData:{type:Object,value:{}}},data:{height:0,title:"",isShowWarning:!0,identifyLevel:!1,showLayer:!1,phone:"",code:"",codeTxt:"获取验证码",codeIsClick:!0,confirmIsClick:!0,countdownValue:120,codeHide:!1,countdownHide:!1,phoneClear:!1,codeClear:!1,countdown:120,phoneFocus:!1,bindState:!1,platForm:"",themeStyle:"--left:#FF5FD2;--right:#B20FD3;--font-color:#B20FD3;"},lifetimes:{attached(){let e="",t=Object(i.b)("identifyLevel"),o=Object(i.b)("isShowWarning");const{appId:n,ctx:a,imgHeight:s,imgUrl:c,imgWidth:d,sharerUnionId:r,sharerUserId:l,code:h,platForm:u,whereFromStr:m,themeConfig:p}=this.data.loginData;if(105==h?e="请绑定一个真快乐账号，此手机号可用于登录和找回密码。":106==h&&(e="为了保障您的账号安全，请完善手机号，此手机号可用于登录和找回密码。"),t=2==t||1==t,"Y"==o&&(o=!0),this.setData({title:e,identifyLevel:t,isShowWarning:o,appId:n,ctx:a,imgUrl:c,imgWidth:d,imgHeight:s,sharerUnionId:r,sharerUserId:l,platForm:u,whereFromStr:m}),p){const{backgroundColor:e,fontColor:t}=p;let o="";e&&(o+=`--background-color:${e};`),t&&(o+=`--font-color:${t};`),this.setData({themeStyle:o})}wx.setNavigationBarTitle({title:e})}},methods:{bindPhoneInput:function(e){let t=!0;const o=e.detail.value,n=o.length;11==n&&(t=!1),this.setData({phone:o,codeIsClick:t,phoneClear:!!n}),this.dealConfirmIsClick()},bindPhoneFocus:function(e){const t=e.detail.value;this.setData({phoneClear:!!t})},bindPhoneBlur:function(e){const t=e.detail.value;this.setData({phoneClear:!!t})},bindCodeInput:function(e){const t=e.detail.value,o=t.length,{phone:n}=this.data;11==n.length&&Object(a.b)(n)?wx.showToast({title:"手机号错误",icon:"none"}):this.setData({code:t,codeClear:!!o}),this.dealConfirmIsClick()},bindCodeFocus:function(e){const t=e.detail.value;this.setData({codeClear:!!t})},bindClearPhone:function(){this.setData({phone:"",phoneClear:!1,codeIsClick:!0}),this.dealConfirmIsClick(),Object(i.c)()},bindClearCode:function(){this.setData({code:"",codeClear:!1}),this.dealConfirmIsClick(),Object(i.c)()},bindCodeBlur:function(e){const t=e.detail.value;this.setData({codeClear:!!t.length})},getCodeEvent:function(e){let t=this;const{appId:o,phone:i,codeIsClick:s,showLayer:c,whereFromStr:d,platForm:r,ctx:l}=this.data;if(s)wx.showToast({title:"请输入手机号",icon:"none"});else if(Object(a.b)(i))wx.showToast({title:"手机号错误",icon:"none"});else{const a={appId:o,mobile:i};d&&(a.whereFrom=d),c?this.setData({showLayer:!1}):(a.isValidatePhone=1,a.isChangeBind="wx"==r?e:""),n.a.sendSMSOnBind(a,l,{success(e){1!=e.data.isShow||c?t.triggerEvent("oldGetCode",{res:e}):t.setData({showLayer:!0})},catch(e){wx.showToast({title:"获取验证码失败，请稍后再试",icon:"none"})}})}},dealCountdown:function(){let e=this;e.data.countdownValue>1?(e.data.countdownValue--,e.setData({codeIsClick:!0,codeTxt:`${e.data.countdownValue}s`}),setTimeout((function(){e.dealCountdown()}),1e3)):e.setData({codeIsClick:!1,countdownHide:!1,countdownValue:120,codeTxt:"重新获取"})},resetCountdown:function(){this.countdownValue=120,this.setData({countdown:this.countdownValue,codeHide:!1,codeTxt:"重新获取",countdownHide:!0})},dealConfirmIsClick:function(){const{phone:e,code:t}=this.data,o=!Object(a.d)(t);let n=!0;11!=e.length||o||(n=!1),this.setData({confirmIsClick:n})},closeLayer:function(){this.setData({showLayer:!1,bindState:!1})},stepoverBind:function(){const{platForm:e,whereFromStr:t}=this.data,o={puserId:Object(i.b)("sharerUserId"),headimg:"ali"==e?Object(i.b)("userInfo").avatar:Object(i.b)("userInfo").avatarUrl,snsUserName:Object(i.b)("userInfo").nickName};t&&(o.whereFrom=t),n.a.stepoverBind(o,{success(e){const{code:t,SCN:o,gradeNO:n,gradeName:a,loginName:s,message:c}=e.data;200==t?(Object(i.d)("scn",o),Object(i.d)("date",Date.now()),Object(i.d)("memberInfo",{gradeNO:n||"",gradeName:a||"",loginName:s||""}),wx.navigateBack({delta:2})):403==t?wx.redirectTo({url:"../loginEmpower/loginEmpower"}):wx.showToast({title:c,icon:"none"})}})},callPhone:function(e){const t=e.target.dataset.phone;wx.makePhoneCall({phoneNumber:t})},doneEvent:function(){const e=this,{appId:t,phone:o,code:s,whereFromStr:c,platForm:d,ctx:r}=this.data;if(Object(a.b)(o)||11!=o.length)wx.showToast({title:"请输入正确的手机号",icon:"none"});else if(6!=s.length)wx.showToast({title:"请输入验证码",icon:"none"});else{const a=Object(i.b)("userInfo"),l=Object(i.b)("sharerUserId"),{avatar:h,avatarUrl:u,nickName:m}=a,p={appId:t,mobile:o,msgCode:s,puserId:l,headimg:"ali"==d?h:u,snsUserName:m};c&&(p.whereFrom=c),n.a.activeMobile(p,r,{success(t){e.triggerEvent("oldActiveMobile",{res:t})}})}},switchDiffAuthory:function(){this.setData({showLayer:!1,isShowAuthoryPhone:!1,bindState:!1,phone:"",phoneClear:!1})},bindPhoneEvent:function(){this.setData({bindState:!1}),this.getCodeEvent(1)},tipsShowModal(e){let t=this;wx.showModal({title:"提示",content:e,cancelText:"更换号码",confirmText:"联系客服",confirmColor:"#F66A6B",success:function(e){e.confirm?wx.makePhoneCall({phoneNumber:"400-811-3333"}):e.cancel&&t.setData({phone:"",code:"",phoneClear:!1,codeClear:!1,codeTxt:"获取验证码",codeIsClick:!1,countdown:120,phoneFocus:!0})}})}}})}},[["../../node_modules/@mpxjs/webpack-plugin/lib/native-loader.js!./src/components/oldUserReg/index.js?packageName=main","bundle"]]]);
export default global['__wxComponents']['gome-login/components/gome-mini/login231c44b8/src/components/oldUserReg/index']
</script>
<style platform="mp-weixin">
.container{background:#fff}.cont{position:relative;flex-direction:column;padding:0 80rpx}.cont,.tit-log{display:flex;width:590rpx}.tit-log{flex-direction:row;justify-content:space-around;padding:67rpx 0}.tit-log .logo{width:194rpx;height:90rpx}.cont-box{display:flex;flex-direction:column}.tips{width:560rpx;line-height:34rpx;font-size:28rpx;color:#ff9a19}.input-phone{position:relative;display:flex;align-items:center;width:590rpx;height:80rpx;margin-top:20rpx;border-bottom:1rpx solid #ddd;padding:0 40rpx 0 0}.icon{width:34rpx;height:34rpx;margin-left:30rpx}.phone{padding-left:30rpx;font-size:30rpx;width:300rpx;line-height:42rpx;color:#00050a}.clear{position:absolute;right:0;top:26rpx;width:40rpx;height:40rpx;display:none}.show{display:block}.error{font-size:24rpx;color:#ff5c5c;line-height:40rpx;padding-left:60rpx}.verify-boxs{display:flex;width:590rpx;margin-top:57rpx}.input-verify{display:flex;position:relative;align-items:center;width:390rpx;border-bottom:1rpx solid #ddd}.input-tips{color:#bfbfbf}.verify{font-size:30rpx;width:220rpx;line-height:42rpx;color:#00050a;padding:0 70rpx 0 30rpx}.input-verify .clear{right:30rpx;top:20rpx}.verify-sends{width:220rpx;border:1rpx solid var(--font-color);border-radius:50rpx;font-size:28rpx;color:var(--font-color);text-align:center}.verify-sends:after{border:none}.verify-sends.style-module_disabled__23RIG,.verify-sends[disabled]:not([type]){color:#bfbfbf;background-color:#fff;border-color:#d8d8d8}.count{border-color:#bfbfbf;color:#bfbfbf}.done{width:100%;height:88rpx;margin-top:58rpx;line-height:88rpx;font-size:32rpx;color:#fff;text-align:center;background-image:linear-gradient(90deg,var(--left),var(--right));background-color:var(--background-color);border-radius:55rpx}.done:after{border:none}.done.style-module_disabled__23RIG,.done[disabled]:not([type]){height:88rpx;color:#fff;opacity:.3;background-color:var(--background-color)}.skip{display:flex;justify-content:flex-end;align-items:center;width:590rpx;height:80rpx}.skip-btn{padding:0 5rpx;color:#00050a;font-size:28rpx;padding-top:40rpx}.layer{width:750rpx;height:0;background:rgba(0,0,0,.6)}.layer,.layer-cont{position:fixed;left:0;z-index:2}.layer-cont{width:690rpx;padding:20rpx 30rpx 0;height:690rpx;bottom:90rpx;background:#fff;display:flex;flex-direction:column}.layer-h1{display:flex;justify-content:space-between;align-items:center;padding:20rpx 0;line-height:40rpx;font-size:32rpx;color:#00050a}.layer-h1>image{width:30rpx;height:30rpx;margin-right:20rpx}.close-cont{font-size:28rpx;line-height:40rpx;overflow:hidden;color:#5a6066}.info-tit{margin-top:10rpx}.call-phone{display:inline-block;color:#36f}.bind-mask{top:0;right:0;bottom:0;z-index:10000;width:100%;background:rgba(0,0,0,.6)}.bind-box,.bind-mask{position:fixed;left:0}.bind-box{z-index:2;width:690rpx;padding:20rpx 30rpx;bottom:90rpx;background:#fff;display:flex;flex-direction:column}.bind-tit{display:flex;justify-content:space-between;align-items:center;padding:20rpx 0;line-height:40rpx;font-size:32rpx;color:#00050a}.bind-tit>image{width:30rpx;height:30rpx;margin-right:20rpx}.layer-h2{padding:20rpx 0;line-height:40rpx;font-size:28rpx;color:#00050a}.bind-btn{position:fixed;z-index:2;width:750rpx;height:90rpx;left:0;bottom:0;background:#fff;display:flex;align-items:center;text-align:center;font-size:32rpx}.change-phone{background:#ccc}.bind-phones,.change-phone{width:50%;line-height:90rpx;color:#fff}.bind-phones{background:#b20fd3;text-align:center}
</style>